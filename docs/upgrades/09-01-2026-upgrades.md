# Package Upgrade Audit - January 9, 2026

## Summary

Comprehensive package audit performed. Project was already on latest versions for 11/12 packages.

**Upgrade performed**: Migrated from `rolldown-vite@7.2.5` to **Vite 8.0.0-beta.7**

## Package Audit Results

| Package | Previous | Current | Notes |
|---------|----------|---------|-------|
| **Dependencies** ||||
| three | ^0.182.0 | ^0.182.0 | Latest - no change |
| @dimforge/rapier3d-compat | ^0.19.3 | ^0.19.3 | Latest - no change |
| comlink | ^4.4.2 | ^4.4.2 | Latest - no change |
| tweakpane | ^4.0.5 | ^4.0.5 | Latest - no change |
| stats.js | ^0.17.0 | ^0.17.0 | Latest - no change |
| **Dev Dependencies** ||||
| typescript | ~5.9.3 | ~5.9.3 | Latest - no change |
| vite | rolldown-vite@7.2.5 | **8.0.0-beta.7** | Upgraded to Vite 8 |
| @tweakpane/core | ^2.0.5 | ^2.0.5 | Latest - no change |
| @types/three | ^0.182.0 | ^0.182.0 | Latest - no change |
| @types/node | ^25.0.3 | ^25.0.3 | Latest - no change |
| @types/stats.js | ^0.17.4 | ^0.17.4 | Latest - no change |
| vite-plugin-glsl | ^1.5.5 | ^1.5.5 | Latest - no change |

## Vite 8 Migration

### Why Vite 8?

- **10-30x faster builds** - Uses Rolldown (Rust-based bundler)
- **Same plugin API** - vite-plugin-glsl works unchanged
- **Future-proof** - Rolldown is the new standard for Vite

### Migration Steps Performed

1. Removed `npm:rolldown-vite@7.2.5` alias
2. Updated to `vite@^8.0.0-beta.7`
3. Removed `overrides` section from package.json
4. Verified build and dev server work

### Verified Compatibility

- Worker bundling with ES modules format
- vite-plugin-glsl shader imports
- Path aliases (~/app, ~/shared, etc.)
- COOP/COEP headers for SharedArrayBuffer
- TypeScript compilation

### Performance Comparison

| Metric | rolldown-vite 7.2.5 | Vite 8.0.0-beta.7 |
|--------|---------------------|-------------------|
| Build time | ~800ms | **385ms** |
| Dev start | ~150ms | **68ms** |

## Package Analysis

### Three.js (r182)

**Status**: Latest stable version

No deprecated APIs in use:
- WebGLRenderer with OffscreenCanvas - stable since r128
- MeshStandardMaterial - stable
- InstancedMesh - stable
- AnimationMixer - stable
- GLTFLoader - stable

### Rapier (0.19.3)

**Status**: Latest stable version

All APIs in use are stable:
- World creation and stepping
- Collider types: cuboid, capsule, ball, heightfield
- Collision event draining
- Raycast queries
- Distance-based sleeping

### TypeScript (5.9.3)

**Status**: Latest stable version

Note: TypeScript 5.9 changed lib.d.ts for ArrayBuffer/TypedArray types. Project's SharedArrayBuffer usage remains compatible with updated @types/node.

### Comlink (4.4.2)

**Status**: Latest stable version

No changes to:
- Worker wrapping/exposing
- Transfer patterns
- Proxy callbacks

## Rollback Instructions

If issues occur with Vite 8, revert to rolldown-vite:

```json
// package.json
{
  "devDependencies": {
    "vite": "npm:rolldown-vite@7.3.0"
  },
  "overrides": {
    "vite": "npm:rolldown-vite@7.3.0"
  }
}
```

Then run:
```bash
bun install
```

## Future Considerations

1. **Vite 8 Stable**: Currently on beta.7, watch for stable release
2. **Three.js r183+**: Monitor for WebGPU improvements
3. **Rapier**: Watch for performance optimizations
